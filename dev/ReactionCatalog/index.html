<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Generic Reaction catalog · PALEOboxes Documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PALEOboxes Documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Design</span><ul><li><a class="tocitem" href="../DesignOverview/">PALEOboxes coupler design</a></li><li><a class="tocitem" href="../CreateInitializeLoop/">Control flow</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../DomainsVariablesFields/">Domains, Variables, Fields, and Data arrays.</a></li><li><a class="tocitem" href="../Solver API/">Solver API</a></li><li><a class="tocitem" href="../Reaction API/">Reaction API</a></li><li class="is-active"><a class="tocitem" href>Generic Reaction catalog</a><ul class="internal"><li><a class="tocitem" href="#Reservoirs"><span>Reservoirs</span></a></li><li><a class="tocitem" href="#Variable-Statistics"><span>Variable Statistics</span></a></li><li><a class="tocitem" href="#Fluxes"><span>Fluxes</span></a></li><li><a class="tocitem" href="#Forcings"><span>Forcings</span></a></li><li><a class="tocitem" href="#Grids"><span>Grids</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../References/">References</a></li><li><a class="tocitem" href="../indexpage/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>Generic Reaction catalog</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Generic Reaction catalog</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/main/docs/src/ReactionCatalog.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Generic-Reaction-catalog"><a class="docs-heading-anchor" href="#Generic-Reaction-catalog">Generic Reaction catalog</a><a id="Generic-Reaction-catalog-1"></a><a class="docs-heading-anchor-permalink" href="#Generic-Reaction-catalog" title="Permalink"></a></h1><p>PALEOboxes includes a catalog of generic Reactions as a starting point for model construction.</p><h2 id="Reservoirs"><a class="docs-heading-anchor" href="#Reservoirs">Reservoirs</a><a id="Reservoirs-1"></a><a class="docs-heading-anchor-permalink" href="#Reservoirs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Reservoirs.ReactionReservoirScalar" href="#PALEOboxes.Reservoirs.ReactionReservoirScalar"><code>PALEOboxes.Reservoirs.ReactionReservoirScalar</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionReservoirScalar</code></pre><p>A single scalar biogeochemical reservoir with optional paired isotope reservoir, for use in a 0D Domain  (eg sedimentary or ocean reservoirs for COPSE <a href="../References/#Bergman2004">N. M. Bergman, Timothy M Lenton, Andrew J Watson (2004)</a>).</p><p>Creates State and associated Variables, depending on parameter settings:</p><ul><li><code>const=false</code>: usual case, create state variable <code>R</code> (units mol, with attribute <code>vfunction=VF_StateExplicit</code>) and <code>R_sms</code> (units mol yr-1, with attribute <code>vfunction=VF_Deriv</code>).</li><li><code>const=true</code>: a constant value, create <code>R</code> (a Property)</li></ul><p>In addition:</p><ul><li>a Property <code>R_norm</code> (normalized value) is always created.</li><li>if parameter <code>field_data &lt;: AbstractIsotopeScalar</code> (eg <code>IsotopeLinear</code>), a Property <code>R_delta</code> is created.</li></ul><p>The local name prefix <code>R</code> should then be renamed using <code>variable_links:</code> in the configuration file.</p><p><strong>Initialisation</strong></p><p>Initial and norm value is set in the <code>variable_attributes:</code> section in    the configuration file, using <code>R:initial_value</code>, <code>R:initial_delta</code>, and <code>R:norm_value</code>.</p><p><strong>Example configuration in .yaml file</strong></p><pre><code class="nohighlight hljs">            reservoir_P:  # 0D ocean Phosphorus
                class: ReactionReservoirScalar
                parameters:
                    # field_data: ScalarData        # change to IsotopeLinear to represent an isotope
                    # const: false                  # true to fix to constant value
                variable_links:
                    R*: P                           # rename to represent Phosphorus
                variable_attributes:
                    R:norm_value:           3.1e15  # mol 
                    R:initial_value:        3.1e15  # mol</code></pre><p><strong>See also</strong></p><p><a href="#PALEOboxes.Reservoirs.ReactionReservoir"><code>ReactionReservoir</code></a> (one value per cell for a spatially resolved Domain eg ocean), <a href="#PALEOboxes.Reservoirs.ReactionReservoirWellMixed"><code>ReactionReservoirWellMixed</code></a> (one value for a whole spatially resolved Domain).</p><p><strong>Parameters</strong></p><ul><li><code>field_data[DataType]</code>=PALEOboxes.ScalarData, <code>default_value</code>=PALEOboxes.ScalarData, <code>allowed_values</code>=Type[PALEOboxes.ScalarData, PALEOboxes.IsotopeLinear], <code>description</code>=&quot;disable / enable isotopes and specify isotope type&quot;</li><li><code>const[Bool]</code>=false, <code>default_value</code>=false, <code>description</code>=&quot;true to provide constant value with no _sms Variable&quot;</li></ul><p><strong>Methods and Variables for default Parameters</strong></p><ul><li><code>methodfn_do_nothing</code><ul><li><code>R_sms</code>  (mol yr-1), <code>VT_ReactContributor</code>, <code>VF_Deriv</code>, <code>description</code>=&quot;scalar reservoir source-sinks&quot;</li></ul></li><li><code>do_reactionreservoirscalar</code><ul><li><code>R</code>  (mol), <code>VT_ReactDependency</code>, <code>VF_StateExplicit</code>, <code>description</code>=&quot;scalar reservoir&quot;</li><li><code>R_norm</code>  (), <code>VT_ReactProperty</code>, <code>description</code>=&quot;scalar reservoir normalized&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Reservoirs.jl#L10-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Reservoirs.ReactionReservoir" href="#PALEOboxes.Reservoirs.ReactionReservoir"><code>PALEOboxes.Reservoirs.ReactionReservoir</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionReservoir,  ReactionReservoirTotal</code></pre><p>A single (vector) reservoir (state variable) representing a biogeochemical tracer, ie one value per cell in a spatially-resolved Domain (eg ocean).</p><p>State Variables created depend on parameters:</p><ul><li><code>stateexplicit=true</code>: usual case to represent an ODE variable and time derivative, create state variable  <code>R</code> (mol m-3, with attribute <code>vfunction=VF_StateExplicit</code>) and <code>R_sms</code> (mol m-3 yr-1, with attribute <code>vfunction=VF_Deriv</code>).</li><li><code>stateexplicit=false</code>: for use with an ODE implicit state variable, create <code>R_sms</code> (with attribute <code>vfunction=VF_Deriv</code>) and a Dependency <code>R</code> (which  should be linked to a Variable with attribute <code>vfunction=VF_Total</code> calculated elsewhere, this Variable should also set the initial value). </li></ul><p>In addition:</p><ul><li>a Property <code>R_conc</code> (concentration in mol m-3) is always created.</li><li>if parameter <code>field_data &lt;: AbstractIsotopeScalar</code> (eg <code>IsotopeLinear</code>), a Property <code>R_delta</code> is created.</li><li><code>ReactionReservoirTotal</code> also calculates the Domain total <code>R_total</code> (units mol), eg to check budgets.</li></ul><p>Local name prefix <code>R</code> should then be renamed using <code>variable_links:</code> in the configuration file.</p><p><strong>Initialisation</strong></p><p>Initial value is set using <code>variable_attributes:</code> in the configuration file, using <code>R:initial_value</code> and <code>R:initial_delta</code> (NB: although <code>initial_value</code> is set on <code>R</code>, it <em>sets concentration in <code>mol m-3</code></em>.)</p><p>Transport is defined by attributes <code>:advect</code>, <code>:vertical_movement</code> (m d-1) set on the concentration variable <code>R_conc</code>. Optical extinction is defined by the <code>:specific_light_extinction</code> (m^2 mol-1) attribute set on the concentration variable <code>R_conc</code>.</p><p><strong>Example configuration in .yaml file</strong></p><pre><code class="nohighlight hljs">            reservoir_P:  # ocean Phosphorus
                class: ReactionReservoirTotal       # include _total (mol)
                parameters:
                    # field_data: ScalarData        # change to IsotopeLinear to represent an isotope                       
                variable_links:
                    R*: P                           # rename to represent Phosphorus
                variable_attributes:
                    R:norm_value:           3e-3    # mol m-3, normalisation value (used by some solvers)
                    R:initial_value:        2e-3    # mol m-3, initial concentration</code></pre><p><strong>See also</strong></p><p><a href="#PALEOboxes.Reservoirs.ReactionReservoirWellMixed"><code>ReactionReservoirWellMixed</code></a> (one value for the whole Domain), <a href="#PALEOboxes.Reservoirs.ReactionReservoirScalar"><code>ReactionReservoirScalar</code></a> (one value for a reservoir in a 0D Domain eg for COPSE <a href="../References/#Bergman2004">N. M. Bergman, Timothy M Lenton, Andrew J Watson (2004)</a>), <a href="#PALEOboxes.Reservoirs.ReactionReservoirConst"><code>ReactionReservoirConst</code></a> (constant time-independent value ie no state variable). </p><p><strong>Parameters</strong></p><ul><li><code>field_data[DataType]</code>=PALEOboxes.ScalarData, <code>default_value</code>=PALEOboxes.ScalarData, <code>allowed_values</code>=Type[PALEOboxes.ScalarData, PALEOboxes.IsotopeLinear], <code>description</code>=&quot;disable / enable isotopes and specify isotope type&quot;</li><li><code>total[Bool]</code>=false, <code>default_value</code>=false, <code>description</code>=&quot;true to calculate R_total&quot;</li><li><code>limit_delta_conc[Float64]</code>=0.0  (mol m-3), <code>default_value</code>=0.0, <code>description</code>=&quot;**EXPERIMENTAL** attempt to limit delta for low/-ve concentrations (0.0 to disable)&quot;</li><li><code>stateexplicit[Bool]</code>=true, <code>default_value</code>=true, <code>description</code>=&quot;true to define a StateExplicit Variable, false to just calculate conc etc from eg a Total Variable defined elsewhere&quot;</li></ul><p><strong>Methods and Variables for default Parameters</strong></p><ul><li><code>methodfn_do_nothing</code><ul><li><code>R_sms</code>  (mol yr-1), <code>VT_ReactContributor</code>, <code>VF_Deriv</code>, <code>description</code>=&quot;vector reservoir source-sinks&quot;</li></ul></li><li><code>do_reactionreservoir</code><ul><li><code>R</code>  (mol), <code>VT_ReactDependency</code>, <code>VF_StateExplicit</code>, <code>description</code>=&quot;vector reservoir&quot;</li><li><code>volume</code>  (m3), <code>VT_ReactDependency</code>, <code>description</code>=&quot;cell volume (or cell phase volume eg for a sediment with solid and liquid phases)&quot;</li><li><code>R_conc</code>  (mol m-3), <code>VT_ReactProperty</code>, <code>description</code>=&quot;concentration&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Reservoirs.jl#L117-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Reservoirs.ReactionReservoirWellMixed" href="#PALEOboxes.Reservoirs.ReactionReservoirWellMixed"><code>PALEOboxes.Reservoirs.ReactionReservoirWellMixed</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionReservoirWellMixed</code></pre><p>A Scalar Reservoir representing a well-mixed tracer in a vector Domain (eg ocean). Provides a scalar state Variable <code>R</code> and <code>R_sms</code>, and also vector Variables: <code>R_conc</code> (set to uniform concentration), and <code>R_vec_sms</code> Target for accumulating fluxes that is added to the scalar <code>R_sms</code>. </p><p><strong>Initialisation</strong></p><p>Initial value is set in the <code>variable_attributes:</code> section in the configuration file, using <code>R:initial_value</code> and <code>R:initial_delta</code>. NB: may be initialized either from mean concentration or total (set by parameter <code>initialization_type</code>)</p><p>TODO salinity normalisation.</p><p><strong>See also</strong></p><p><a href="#PALEOboxes.Reservoirs.ReactionReservoir"><code>ReactionReservoir</code></a> (one value per cell), <a href="#PALEOboxes.Reservoirs.ReactionReservoirScalar"><code>ReactionReservoirScalar</code></a> (one value for a reservoir in a 0D Domain eg for COPSE <a href="../References/#Bergman2004">N. M. Bergman, Timothy M Lenton, Andrew J Watson (2004)</a>).</p><p><strong>Parameters</strong></p><ul><li><code>field_data[DataType]</code>=PALEOboxes.ScalarData, <code>default_value</code>=PALEOboxes.ScalarData, <code>allowed_values</code>=Type[PALEOboxes.ScalarData, PALEOboxes.IsotopeLinear], <code>description</code>=&quot;disable / enable isotopes and specify isotope type&quot;</li><li><code>initialization_type[String]</code>=&quot;conc&quot;, <code>default_value</code>=&quot;conc&quot;, <code>allowed_values</code>=[&quot;conc&quot;, &quot;total&quot;], <code>description</code>=&quot;:initial_value attribute represents conc (mol m-3) or total (mol)&quot;</li></ul><p><strong>Methods and Variables for default Parameters</strong></p><ul><li><code>do_reservoir_well_mixed</code><ul><li><code>R</code>  (mol), <code>VT_ReactDependency</code>, <code>VF_StateExplicit</code>, <code>description</code>=&quot;scalar reservoir&quot;</li><li><code>R_norm</code>  (), <code>VT_ReactProperty</code>, <code>description</code>=&quot;scalar reservoir normalized&quot;</li><li><code>R_conc</code>  (mol m-3), <code>VT_ReactProperty</code>, <code>description</code>=&quot;concentration&quot;</li><li><code>volume_total</code>  (m^3), <code>VT_ReactDependency</code>, <code>description</code>=&quot;total volume&quot;</li></ul></li><li><code>do_reservoir_well_mixed_sms</code><ul><li><code>R_sms</code>  (mol yr-1), <code>VT_ReactContributor</code>, <code>VF_Deriv</code>, <code>description</code>=&quot;scalar reservoir source-sinks&quot;</li><li><code>R_vec_sms</code>  (mol yr-1), <code>VT_ReactTarget</code>, <code>description</code>=&quot;vector reservoir source-sinks&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Reservoirs.jl#L435-L457">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Reservoirs.ReactionReservoirConst" href="#PALEOboxes.Reservoirs.ReactionReservoirConst"><code>PALEOboxes.Reservoirs.ReactionReservoirConst</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionReservoirConst</code></pre><p>A single (vector) constant tracer <code>R_conc</code> (constant replacement for a <a href="#PALEOboxes.Reservoirs.ReactionReservoir"><code>ReactionReservoir</code></a>).</p><p>Local name prefix <code>R</code> should then be renamed using <code>variable_links:</code> in the configuration file.</p><p><strong>Initialisation</strong></p><p>Set <code>:initial_value</code>, <code>:initial_delta</code> on <code>R_conc</code> (mol m-3) in the <code>variable_attributes:</code> section of the config file.</p><p>TODO salinity normalisation.</p><p><strong>Example configuration in .yaml file</strong></p><pre><code class="nohighlight hljs">            reservoir_B:  # Constant value for ocean Boron 
                class: ReactionReservoirConst
                parameters:
                    field_data: IsotopeLinear
                variable_links:
                    R*: B
                variable_attributes:                      
                    R_conc:initial_value:       0.4269239 # contemporary value
                    R_conc:initial_delta:       34.0</code></pre><p><strong>See also</strong></p><p><a href="#PALEOboxes.Reservoirs.ReactionReservoir"><code>ReactionReservoir</code></a></p><p><strong>Parameters</strong></p><ul><li><code>field_data[DataType]</code>=PALEOboxes.ScalarData, <code>default_value</code>=PALEOboxes.ScalarData, <code>allowed_values</code>=Type[PALEOboxes.ScalarData, PALEOboxes.IsotopeLinear], <code>description</code>=&quot;disable / enable isotopes and specify isotope type&quot;</li></ul><p><strong>Methods and Variables</strong></p><ul><li><code>setup_initialvalue_vars_default</code><ul><li><code>R_conc</code>  (mol m-3), <code>VT_ReactProperty</code>, <code>description</code>=&quot;concentration&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Reservoirs.jl#L281-L313">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Reservoirs.ReactionReservoirForced" href="#PALEOboxes.Reservoirs.ReactionReservoirForced"><code>PALEOboxes.Reservoirs.ReactionReservoirForced</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionReservoirForced</code></pre><p>A single (vector) constant tracer (constant replacement for a <a href="#PALEOboxes.Reservoirs.ReactionReservoir"><code>ReactionReservoir</code></a>), with forcing.</p><p>Calculates <code>R_conc = R_conc_initial * R_FORCE</code>.</p><p>Local name prefix <code>R</code> should then be renamed using <code>variable_links:</code> in the configuration file.</p><p><strong>Initialisation</strong></p><p>NB: set <code>:initial_value</code>, <code>:initial_delta</code> on <code>R_conc_initial</code> in the <code>variable_attributes:</code> section of the config file.</p><p>TODO salinity normalisation.</p><p><strong>See also</strong></p><p><a href="#PALEOboxes.Reservoirs.ReactionReservoirConst"><code>ReactionReservoirConst</code></a>, <a href="#PALEOboxes.Reservoirs.ReactionReservoir"><code>ReactionReservoir</code></a></p><p><strong>Parameters</strong></p><ul><li><code>field_data[DataType]</code>=PALEOboxes.ScalarData, <code>default_value</code>=PALEOboxes.ScalarData, <code>allowed_values</code>=Type[PALEOboxes.ScalarData, PALEOboxes.IsotopeLinear], <code>description</code>=&quot;disable / enable isotopes and specify isotope type&quot;</li></ul><p><strong>Methods and Variables for default Parameters</strong></p><ul><li><code>do_reactionreservoirconstforced</code><ul><li><code>R_conc_initial</code>  (mol m-3), <code>VT_ReactProperty</code>, <code>description</code>=&quot;initial concentration&quot;</li><li><code>R_conc</code>  (mol m-3), <code>VT_ReactProperty</code>, <code>description</code>=&quot;concentration = initial * forcing&quot;</li><li><code>R_FORCE</code>  (), <code>VT_ReactDependency</code>, <code>description</code>=&quot;forcing factor&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Reservoirs.jl#L354-L377">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Reservoirs.ReactionConst" href="#PALEOboxes.Reservoirs.ReactionConst"><code>PALEOboxes.Reservoirs.ReactionConst</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionConst, ReactionScalarConst</code></pre><p>Create constant Property Variables with names from parameter <code>constnames</code>. </p><p><strong>Initialisation</strong></p><p>Constant values set by <code>:initial_value</code>, <code>:initial_delta</code> attributes in the <code>variable_attributes:</code> section of the configuration file.</p><p><strong>Example configuration in .yaml file</strong></p><pre><code class="nohighlight hljs">    atmfloor:
        reactions:                
            floorstubgasmr:  # Provide mixing-ratio boundary condition for a subset of atmospheric variables
                class: ReactionConst
                parameters:
                    constnames: [&quot;O2_mr&quot;, &quot;CH4_mr&quot;, &quot;CO2_mr&quot;, &quot;H2_mr&quot;] #, &quot;H2O_mr&quot;]  
                variable_attributes:        
                    O2_mr:initial_value:  [0.21]  # mol/mol
                    CH4_mr:initial_value:  [0.7443e-6] # [.NaN] # [1.271e-6] # [1.8e-6]  # mol/mol
                    CO2_mr:initial_value:  [300e-6]  # mol/mol
                    H2_mr:initial_value:   [.NaN]  # mol/mol</code></pre><p><strong>See also</strong></p><p><a href="#PALEOboxes.Reservoirs.ReactionReservoirConst"><code>ReactionReservoirConst</code></a>, <a href="#PALEOboxes.Reservoirs.ReactionReservoirScalar"><code>ReactionReservoirScalar</code></a>.  These provide additional variables (eg <code>R_delta</code>) to  allow them to function as a drop-in replacement for a non-constant Reservoir.</p><p><strong>Parameters</strong></p><ul><li><code>constnames[Vector{String}]</code>=[&quot;constvar&quot;], <code>default_value</code>=[&quot;constvar&quot;], <code>description</code>=&quot;vector of names for constant Variables. Isotopes use &lt;name&gt;::CIsotope syntax&quot;</li></ul><p><strong>Methods and Variables for default Parameters</strong></p><ul><li><code>setup_initialvalue_vars_default</code><ul><li><code>constvar</code>  (), <code>VT_ReactProperty</code>, <code>description</code>=&quot;constant value&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Reservoirs.jl#L578-L608">source</a></section></article><h3 id="Linking-to-Reservoirs-from-a-Reaction"><a class="docs-heading-anchor" href="#Linking-to-Reservoirs-from-a-Reaction">Linking to Reservoirs from a Reaction</a><a id="Linking-to-Reservoirs-from-a-Reaction-1"></a><a class="docs-heading-anchor-permalink" href="#Linking-to-Reservoirs-from-a-Reaction" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Reservoirs.ReservoirLinksVector" href="#PALEOboxes.Reservoirs.ReservoirLinksVector"><code>PALEOboxes.Reservoirs.ReservoirLinksVector</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ReservoirLinksVector(isotope_data::Dict, reservoirlist) -&gt; (res::Vector, sms::Vector, diag::Vector)</code></pre><p>Convenience function to create variables required for a Reaction to link to a list of Reservoir variables. <code>res</code> contains VariableReactions <code>&lt;reservoir_name&gt;</code>, <code>sms</code> <code>&lt;reservoir_name&gt;_sms</code> that link to <code>State</code>, <code>State_sms</code> variables. <code>diag</code> contains VariableReactions <code>&lt;reservoir_name&gt;_norm</code> etc that link to additional properties.</p><p><strong>Arguments</strong></p><ul><li><code>reservoirlist::[(reservoir_name[::Isotope],       units,   description), ...]</code>: list of Reservoirs</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Reservoirs.jl#L647-L656">source</a></section></article><h2 id="Variable-Statistics"><a class="docs-heading-anchor" href="#Variable-Statistics">Variable Statistics</a><a id="Variable-Statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Variable-Statistics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.VariableStats.ReactionSum" href="#PALEOboxes.VariableStats.ReactionSum"><code>PALEOboxes.VariableStats.ReactionSum</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionSum, ReactionVectorSum</code></pre><p>A sum of variables (eg budget).</p><ul><li>If Parameter <code>component_to_add == 0</code>, all components of Isotopes are included.</li><li>If Parameter <code>component_to_add == component_number</code>, a single component only is included.</li></ul><p><strong>Parameters</strong></p><ul><li><code>vars_to_add[Vector{String}]</code>=[&quot;2\<em>myvar&quot;, &quot;myothervar&quot;, &quot;-1\</em>mythirdvar&quot;], <code>default_value</code>=[&quot;2\<em>myvar&quot;, &quot;myothervar&quot;, &quot;-1\</em>mythirdvar&quot;], <code>description</code>=&quot;vector of variable names to add, eg [2*myvar, myothervar, -1*mythirdvar]&quot;</li><li><code>vars_prefix[String]</code>=&quot;&quot;, <code>default_value</code>=&quot;&quot;, <code>description</code>=&quot;optional prefix for vars_to_add&quot;</li><li><code>component_to_add[Int64]</code>=0, <code>default_value</code>=0, <code>description</code>=&quot;component to add, 0 for all&quot;</li><li><code>vectorsum[Bool]</code>=false, <code>default_value</code>=false, <code>description</code>=&quot;true to accumulate sum into vector Variable, false to accumulate sum into scalar (adding vector cells if necessary)&quot;</li></ul><p><strong>Methods and Variables for default Parameters</strong></p><ul><li><code>do_scalarsum</code><ul><li><code>sum</code>  (), <code>VT_ReactProperty</code>, <code>description</code>=&quot;sum of specified variables&quot;</li><li>[<code>myvar</code>]  (), <code>VT_ReactDependency</code>, <code>description</code>=&quot;&quot;</li><li>[<code>myothervar</code>]  (), <code>VT_ReactDependency</code>, <code>description</code>=&quot;&quot;</li><li>[<code>mythirdvar</code>]  (), <code>VT_ReactDependency</code>, <code>description</code>=&quot;&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/VariableStats.jl#L10-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.VariableStats.ReactionWeightedMean" href="#PALEOboxes.VariableStats.ReactionWeightedMean"><code>PALEOboxes.VariableStats.ReactionWeightedMean</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionWeightedMean</code></pre><p>Weighted mean (eg by area or volume) of Variable</p><p><strong>Parameters</strong></p><ul><li><code>field_data[DataType]</code>=PALEOboxes.ScalarData, <code>default_value</code>=PALEOboxes.ScalarData, <code>allowed_values</code>=Type[PALEOboxes.ScalarData, PALEOboxes.IsotopeLinear], <code>description</code>=&quot;disable / enable isotopes and specify isotope type&quot;</li></ul><p><strong>Methods and Variables</strong></p><ul><li><code>do_weighted_mean</code><ul><li><code>var</code>  (measure-1), <code>VT_ReactDependency</code>, <code>description</code>=&quot;variable to calculate weighted mean from&quot;</li><li><code>measure</code>  (), <code>VT_ReactDependency</code>, <code>description</code>=&quot;cell area or volume&quot;</li><li><code>measure_total</code>  (), <code>VT_ReactDependency</code>, <code>description</code>=&quot;total Domain area or volume&quot;</li><li><code>var_mean</code>  (), <code>VT_ReactProperty</code>, <code>description</code>=&quot;weighted mean over Domain area or volume&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/VariableStats.jl#L195-L205">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.VariableStats.ReactionAreaVolumeValInRange" href="#PALEOboxes.VariableStats.ReactionAreaVolumeValInRange"><code>PALEOboxes.VariableStats.ReactionAreaVolumeValInRange</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionAreaVolumeValInRange</code></pre><p>Fraction of Domain area or volume with Variable in a range of values.</p><p><strong>Parameters</strong></p><ul><li><code>range_min[Float64]</code>=-Inf  (mol m-3), <code>default_value</code>=-Inf, <code>description</code>=&quot;minimum value to include in frac&quot;</li><li><code>range_max[Float64]</code>=Inf  (mol m-3), <code>default_value</code>=Inf, <code>description</code>=&quot;maximum value to include in frac&quot;</li></ul><p><strong>Methods and Variables</strong></p><ul><li><code>do_area_volume_in_range</code><ul><li><code>rangevar</code>  (mol m-3), <code>VT_ReactDependency</code>, <code>description</code>=&quot;variable to check within range&quot;</li><li><code>measure</code>  (), <code>VT_ReactDependency</code>, <code>description</code>=&quot;cell area or volume&quot;</li><li><code>measure_total</code>  (), <code>VT_ReactDependency</code>, <code>description</code>=&quot;total Domain area or volume&quot;</li><li><code>frac</code>  (), <code>VT_ReactProperty</code>, <code>description</code>=&quot;fraction of Domain area or volume in specified range&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/VariableStats.jl#L252-L262">source</a></section></article><h2 id="Fluxes"><a class="docs-heading-anchor" href="#Fluxes">Fluxes</a><a id="Fluxes-1"></a><a class="docs-heading-anchor-permalink" href="#Fluxes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Fluxes" href="#PALEOboxes.Fluxes"><code>PALEOboxes.Fluxes</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">Fluxes</code></pre><p>Create and manage collections of Target and Contrib Variables used to define fluxes within or between Domains.</p><p><strong>Conventions for defining biogeochemical fluxes within Domains</strong></p><ul><li>Particulate organic matter (including CaCO3) with stoichiometry Corg:N:P:Ccarb is usually transferred as: <code>flux_list</code> <code>[&quot;P&quot;, &quot;N&quot;, &quot;Corg::CIsotope&quot;, &quot;Ccarb::CIsotope&quot;]</code> with a prefix indicating the function (eg <code>export_</code>).</li><li>Solute fluxes are usually transferred as: <code>flux_list</code>  <code>[&quot;DIC::CIsotope&quot;, &quot;TAlk&quot;, &quot;Ca&quot;, &quot;P&quot;, &quot;O2&quot;, &quot;SO4::SIsotope&quot;, &quot;H2S::SIsotope&quot;, &quot;CH4::CIsotope&quot;]</code> (where these names match the Reservoir names for the solutes), with a prefix indicating the function (usually just <code>flux_</code> or <code>soluteflux_</code>).</li></ul><p><strong>Conventions for defining global fluxes between modules</strong></p><p>The model configuration <code>.yaml</code> file should create  a <code>Domain</code> for each global flux, containing one or more <a href="#PALEOboxes.Fluxes.ReactionFluxTarget"><code>Fluxes.ReactionFluxTarget</code></a>.  Fluxes are then transferred (copied) by adding a <a href="#PALEOboxes.Fluxes.ReactionFluxTransfer"><code>Fluxes.ReactionFluxTransfer</code></a> to each destination Domain.</p><p>Naming conventions for Earth system fluxes:</p><table><tr><th style="text-align: left">Domain name</th><th style="text-align: left">target prefix</th><th style="text-align: left">flux_list (illustrative, add as needed)</th></tr><tr><td style="text-align: left">fluxAtoLand</td><td style="text-align: left">flux_</td><td style="text-align: left">[&quot;CO2::CIsotope&quot;, &quot;O2&quot;]</td></tr><tr><td style="text-align: left">fluxRtoOcean</td><td style="text-align: left">flux_</td><td style="text-align: left">[&quot;DIC::CIsotope&quot;, &quot;TAlk&quot;, &quot;Ca&quot;, &quot;P&quot;, &quot;SO4::SIsotope&quot;]</td></tr><tr><td style="text-align: left">fluxOceanBurial</td><td style="text-align: left">flux_</td><td style="text-align: left">[&quot;Corg::CIsotope&quot;, &quot;Ccarb::CIsotope&quot;, &quot;Porg&quot;, &quot;Pauth&quot;, &quot;PFe&quot;, &quot;P&quot;, &quot;GYP::SIsotope&quot;, &quot;PYR::SIsotope&quot;]</td></tr><tr><td style="text-align: left">fluxSedCrusttoAOcean</td><td style="text-align: left">flux_</td><td style="text-align: left">[&quot;C::CIsotope&quot;, &quot;S::SIsotope&quot;, &quot;Redox&quot;]</td></tr><tr><td style="text-align: left">fluxLandtoSedCrust</td><td style="text-align: left">flux_</td><td style="text-align: left">[&quot;Ccarb::CIsotope&quot;, &quot;Corg::CIsotope&quot;, &quot;GYP::SIsotope&quot;, &quot;PYR::SIsotope&quot;]</td></tr><tr><td style="text-align: left">fluxOceanfloor</td><td style="text-align: left">particulateflux_</td><td style="text-align: left">[&quot;P&quot;, &quot;N&quot;, &quot;Corg::CIsotope&quot;, &quot;Ccarb::CIsotope&quot;]</td></tr><tr><td style="text-align: left"></td><td style="text-align: left">soluteflux_</td><td style="text-align: left">[&quot;DIC::CIsotope&quot;, &quot;TAlk&quot;, &quot;Ca&quot;, &quot;P&quot;, &quot;O2&quot;, &quot;SO4::SIsotope&quot;, &quot;H2S::SIsotope&quot;, &quot;CH4::CIsotope&quot;]</td></tr><tr><td style="text-align: left">fluxAtmtoOceansurface</td><td style="text-align: left">flux_</td><td style="text-align: left">[&quot;CO2::CIsotope&quot;, &quot;CH4::CIsotope&quot;, &quot;O2&quot;]</td></tr></table></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Fluxes.jl#L1-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Fluxes.ReactionFluxTarget" href="#PALEOboxes.Fluxes.ReactionFluxTarget"><code>PALEOboxes.Fluxes.ReactionFluxTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionFluxTarget</code></pre><p>Provides either a target for fluxes from <code>fluxlist</code> in an input <code>Domain</code> or a constant stub, optionally calculates totals.</p><p>For each <code>fluxname</code> in <code>fluxlist</code>, creates:</p><ul><li>if <code>const_stub==false</code>, an input <code>VarTarget</code> <code>pars.target_prefix.v*&quot;flux_&quot;*fluxname</code> (or if <code>const_stub==true</code>, a constant <code>VarProp</code>).</li><li>if <code>flux_totals</code> is <code>true</code>, a total <code>VarPropScalar</code> <code>target_prefix.v*&quot;flux_total_&quot;*fluxname</code>.</li></ul><p><strong>Parameters</strong></p><ul><li><code>fluxlist[Vector{String}]</code>=[&quot;example&quot;], <code>default_value</code>=[&quot;example&quot;], <code>description</code>=&quot;available fluxes&quot;</li><li><code>target_prefix[String]</code>=&quot;flux_&quot;, <code>default_value</code>=&quot;flux_&quot;, <code>description</code>=&quot;target names will be &quot;&lt;target_prefix&gt;&lt;fluxname&gt;&quot;,                            target total names will be &quot;&lt;target_prefix&gt;total_&lt;fluxname&gt;&quot;               (where &lt;fluxname&gt; is an entry in fluxlist)&quot;</li><li><code>flux_totals[Bool]</code>=false, <code>default_value</code>=false, <code>description</code>=&quot;true to calculate flux totals (as &quot;&lt;target_prefix&gt;flux_total_&lt;fluxname&gt;&quot;)&quot;</li><li><code>const_stub[Bool]</code>=false, <code>default_value</code>=false, <code>description</code>=&quot;true to provide constant flux defined by :initial_value, :initial_delta attributes on input Target Variables &quot;&lt;target_prefix&gt;flux_&lt;fluxname&gt;&quot;&quot;</li></ul><p><strong>Methods and Variables for default Parameters</strong></p><ul><li><code>methodfn_do_nothing</code><ul><li><code>flux_example</code>  (mol yr-1), <code>VT_ReactTarget</code>, <code>description</code>=&quot;flux input&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Fluxes.jl#L141-L156">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Fluxes.ReactionFluxTransfer" href="#PALEOboxes.Fluxes.ReactionFluxTransfer"><code>PALEOboxes.Fluxes.ReactionFluxTransfer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionFluxTransfer</code></pre><p>Copy fluxes, optionally using transfer matrices to define cell-cell mappings if input and output fluxes  are in a different Domain.</p><p>There are three common cases:</p><ul><li>Transfer within a Domain, using <code>transfer_matrix</code> <code>Identity</code></li><li>Transfer from a <code>fluxXXX</code> Domain to the Domain hosting the <code>ReactionFluxTransfer</code>, using <code>transfer_matrix</code> to define a mapping if these Domains are of different sizes.  </li><li>Transfer from a <code>fluxXXX</code> Domain to the boundary cells of an interior Domain (eg <code>ocean.oceansurface</code>),  where the Domain hosting the <code>ReactionFluxTransfer</code> is the corresponding boundary Domain (eg <code>oceansurface</code>).</li></ul><p><strong>Parameters</strong></p><ul><li><code>fluxlist[Vector{String}]</code>=String[], <code>default_value</code>=String[], <code>description</code>=&quot;available fluxes&quot;</li><li><code>input_fluxes[String]</code>=&quot;[inputdomain.][inputsubdomain.]flux_<span>$</span>fluxname<span>$</span>&quot;, <code>default_value</code>=&quot;[inputdomain.][inputsubdomain.]flux_<span>$</span>fluxname<span>$</span>&quot;, <code>description</code>=&quot;string to match to find input flux Variables. These Variables will local names &quot;input_<span>$</span>fluxname<span>$</span>&quot;.&quot;</li><li><code>output_fluxes[String]</code>=&quot;[outputdomain.][outputsubdomain.]<span>$</span>fluxname<span>$</span>_sms&quot;, <code>default_value</code>=&quot;[outputdomain.][outputsubdomain.]<span>$</span>fluxname<span>$</span>_sms&quot;, <code>description</code>=&quot;string to use to generate output flux Variables where <span>$</span>fluxname<span>$</span> is substituted from input_fluxes. These Variables will local names &quot;output_<span>$</span>fluxname<span>$</span>&quot;, and are optional (ie ignored if not linked). Usually the output Domain is the Domain hosting the ReactionFluxTransfer (in general, it must be a Domain of the same size as the Domain hosting the ReactionFluxTransfer).&quot;</li><li><code>transfer_multiplier[Float64]</code>=1.0, <code>default_value</code>=1.0, <code>description</code>=&quot;scalar multiplier for transfer&quot;</li><li><code>transfer_matrix[String]</code>=&quot;Identity&quot;, <code>default_value</code>=&quot;Identity&quot;, <code>allowed_values</code>=[&quot;Identity&quot;, &quot;Distribute&quot;, &quot;Custom&quot;], <code>description</code>=&quot;matrix defining input Domain (length n) -&gt; output Domain (length m) mapping:                &#39;Identity&#39; copies fluxes directly, requires m == n;                &#39;Distribute&#39; uniformly distributes fluxes from input-&gt;output: sums over n and them distributes fraction 1/m evenly to each m;               &#39;Custom&#39; requires transfer matrix to be supplied&quot;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Fluxes.jl#L233-L248">source</a></section></article><h3 id="Contributing-to-flux-couplers-from-a-Reaction"><a class="docs-heading-anchor" href="#Contributing-to-flux-couplers-from-a-Reaction">Contributing to flux couplers from a Reaction</a><a id="Contributing-to-flux-couplers-from-a-Reaction-1"></a><a class="docs-heading-anchor-permalink" href="#Contributing-to-flux-couplers-from-a-Reaction" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Fluxes.FluxContrib" href="#PALEOboxes.Fluxes.FluxContrib"><code>PALEOboxes.Fluxes.FluxContrib</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">FluxContrib(
    fluxprefix::AbstractString, flux_list;
    [, isotope_data::Dict]
    [, space=PB.CellSpace][, alloptional=true]
) -&gt; vartuple::NamedTuple</code></pre><p>Create a <code>NamedTuple</code> of <code>VarContrib</code> from <code>flux_prefix.*flux_list</code>, needed for a Reaction to write to a flux coupler. Entries in <code>flux_list</code> of form <code>fluxname::isotope</code> are parsed to look up isotope type from <code>isotope_data</code> Dict.</p><p>For each <code>fluxname</code> in <code>flux_list</code>, the generated <code>VarContrib</code> <code>vartuple.fluxname</code> have <code>link_namestr=$(fluxprefix)$(fluxname)&quot;</code> and  <code>localname=&quot;$(fluxprefix)$(fluxname)</code> (with any <code>.</code> in <code>fluxprefix</code> substituted to <code>_</code>).</p><p><strong>Example:</strong></p><pre><code class="language-julia hljs">julia&gt; fluxRtoOcean = PB.Fluxes.FluxContrib(&quot;fluxRtoOcean.flux_&quot;, [&quot;P&quot;, &quot;SO4::SIsotope&quot;], isotope_data=Dict(&quot;SIsotope&quot;=&gt;PB.IsotopeLinear), space=PB.ScalarSpace);

julia&gt; fluxRtoOcean.P
PALEOboxes.VariableReaction{PALEOboxes.VT_ReactContributor}
  localname=&#39;fluxRtoOcean_flux_P&#39;
  link_name=&#39;fluxRtoOcean.flux_P[unlinked]&#39;
  attributes=Dict{Symbol, Any}(:description =&gt; &quot;flux P&quot;, :space =&gt; PALEOboxes.ScalarSpace, :standard_variable =&gt; false, :norm_value =&gt; 1.0, :data_dims =&gt; String[], :long_name =&gt; &quot;&quot;, :vfunction =&gt; PALEOboxes.VF_Undefined, :field_data =&gt; PALEOboxes.ScalarData, :initial_delta =&gt; 0.0, :units =&gt; &quot;mol yr-1&quot;…)

julia&gt; fluxRtoOcean.SO4
PALEOboxes.VariableReaction{PALEOboxes.VT_ReactContributor}
  localname=&#39;fluxRtoOcean_flux_SO4&#39;
  link_name=&#39;fluxRtoOcean.flux_SO4[unlinked]&#39;
  attributes=Dict{Symbol, Any}(:description =&gt; &quot;flux SO4&quot;, :space =&gt; PALEOboxes.ScalarSpace, :standard_variable =&gt; false, :norm_value =&gt; 1.0, :data_dims =&gt; String[], :long_name =&gt; &quot;&quot;, :vfunction =&gt; PALEOboxes.VF_Undefined, :field_data =&gt; PALEOboxes.IsotopeLinear, :initial_delta =&gt; 0.0, :units =&gt; &quot;mol yr-1&quot;…)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Fluxes.jl#L45-L75">source</a></section></article><h2 id="Forcings"><a class="docs-heading-anchor" href="#Forcings">Forcings</a><a id="Forcings-1"></a><a class="docs-heading-anchor-permalink" href="#Forcings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.Forcings.ReactionForceInterp" href="#PALEOboxes.Forcings.ReactionForceInterp"><code>PALEOboxes.Forcings.ReactionForceInterp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionForceInterp</code></pre><p>Provide a scalar Property <code>F</code>, linearly interpolated from a table of values vs time <code>tforce</code>.</p><p>The table of values is set by parameters <code>force_times</code> and <code>force_value</code>.</p><p>The input time Variable is <code>tforce</code>, with default linking to the <code>global.tforce</code> Variable.</p><p>Use the configuration file to rename the output variable <code>F</code> (and if necessary, the input Variable <code>tforce</code>).</p><p>NB: no extrapolation ! (so eg set guard values for <code>force_times</code> at -1e30, 1e30)</p><p><strong>Parameters</strong></p><ul><li><code>force_times[Vector{Float64}]</code>=[-1.0e30, 1.0e30]  (yr), <code>default_value</code>=[-1.0e30, 1.0e30], <code>description</code>=&quot;interpolated forcing times&quot;</li><li><code>force_values[Vector{Float64}]</code>=[1.0, 1.0], <code>default_value</code>=[1.0, 1.0], <code>description</code>=&quot;interpolated forcing values&quot;</li></ul><p><strong>Methods and Variables</strong></p><ul><li><code>do_forceinterp</code><ul><li><code>tforce</code> –&gt; global.tforce  (yr), <code>VT_ReactDependency</code>, <code>description</code>=&quot;historical time at which to apply forcings, present = 0 yr&quot;</li><li><code>F</code>  (), <code>VT_ReactProperty</code>, <code>description</code>=&quot;interpolated forcing&quot;</li></ul></li></ul><pre><code class="nohighlight hljs"></code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/Forcings.jl#L7-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.GridForcings.ReactionForceGrid" href="#PALEOboxes.GridForcings.ReactionForceGrid"><code>PALEOboxes.GridForcings.ReactionForceGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionForceGrid</code></pre><p>Apply time-dependent, periodic forcing from a variable in a netcdf or Matlab file, optionally applying a scaling, a constant linear offset, and a linear offset generated from a scalar model variable.</p><p>Reads records <code>tidx_start</code>:<code>tidx_end</code> (assumed to be the last dimension) for <code>data_var</code> from a gridded dataset in <code>netcdf_file</code> or <code>matlab_file</code>, maps grid to linear using the Domain grid (which must match that of <code>data_var</code>).</p><p>If <code>tidx_end &gt; tidx_start</code> (ie multiple records), reads a netcdf or Matlab variable named <code>time_var</code>, applies periodicity <code>cycle_time</code>, and uses this to linearly interpolate to model time.</p><p>Then applies forcing:</p><pre><code class="nohighlight hljs">F = scale*`data_var` + constant_offset + scale_offset_var*`scalar_offset_var`</code></pre><p>Optionally (if <code>interp_vars</code> is non-empty), interpolate forcing from additional dimensions in the netcdf file, given values supplied by additional Variable dependencies. NB: netcdf dimensions order must be <code>grid_vars</code> x <code>interp_vars</code><code>x</code>time<em>var<code>, where order within</code>interp</em>vars` also must match netcdf order.</p><p><strong>Parameters</strong></p><ul><li><code>netcdf_file[String]</code>=&quot;&quot;, <code>default_value</code>=&quot;&quot;, <code>description</code>=&quot;netcdf file with gridded time-series data&quot;</li><li><code>matlab_file[String]</code>=&quot;&quot;, <code>default_value</code>=&quot;&quot;, <code>description</code>=&quot;matlab file with gridded time-series data&quot;</li><li><code>data_var[String]</code>=&quot;&quot;, <code>default_value</code>=&quot;&quot;, <code>description</code>=&quot;variable name in data file&quot;</li><li><code>time_var[String]</code>=&quot;time&quot;, <code>default_value</code>=&quot;time&quot;, <code>description</code>=&quot;time variable name in data file (empty to generate evenly spaced times from cycle_time)&quot;</li><li><code>tidx_start[Int64]</code>=1, <code>default_value</code>=1, <code>description</code>=&quot;first record in data file to use&quot;</li><li><code>tidx_end[Int64]</code>=1, <code>default_value</code>=1, <code>description</code>=&quot;last record in data file to use (set equal to tidx_start for constant forcing from single record)&quot;</li><li><code>use_timeav[Bool]</code>=false, <code>default_value</code>=false, <code>description</code>=&quot;true to average records and provide constant forcing at time-averaged value&quot;</li><li><code>cycle_time[Float64]</code>=1.0  (yr), <code>default_value</code>=1.0, <code>description</code>=&quot;time periodicity to apply (0.0 to disable periodic)&quot;</li><li><code>interp_vars[Vector{String}]</code>=String[], <code>default_value</code>=String[], <code>description</code>=&quot;optional interpolation variables for additional grid dimensions. NB: netcdf dimensions order must be grid_vars x interp_vars x time_var, where order within interp_vars also must match netcdf order&quot;</li><li><code>interp_log[Vector{Bool}]</code>=Bool[], <code>default_value</code>=Bool[], <code>description</code>=&quot;true to interpolate interp_vars in log space&quot;</li><li><code>scale[Float64]</code>=1.0, <code>default_value</code>=1.0, <code>description</code>=&quot;scaling factor to apply&quot;</li><li><code>constant_offset[Float64]</code>=0.0, <code>default_value</code>=0.0, <code>description</code>=&quot;constant offset to apply&quot;</li><li><code>scale_offset_var[Float64]</code>=0.0, <code>default_value</code>=0.0, <code>description</code>=&quot;scaling for additional scalar offset from model variable (0.0 to disable)&quot;</li></ul><p><strong>Methods and Variables for default Parameters</strong></p><ul><li><code>do_force_grid</code><ul><li><code>tforce</code> –&gt; global.tforce  (yr), <code>VT_ReactDependency</code>, <code>description</code>=&quot;historical time at which to apply forcings, present = 0 yr&quot;</li><li><code>F</code>  (), <code>VT_ReactProperty</code>, <code>description</code>=&quot;interpolated forcing&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/GridForcings.jl#L12-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.FluxPerturb.ReactionFluxPerturb" href="#PALEOboxes.FluxPerturb.ReactionFluxPerturb"><code>PALEOboxes.FluxPerturb.ReactionFluxPerturb</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionFluxPerturb</code></pre><p>Provide a scalar flux <code>F</code>, linearly interpolated from a table of values vs time <code>tforce</code>.</p><p>The table of values is set by parameters <code>perturb_times</code> and <code>perturb_totals</code>, and optionally <code>perturb_deltas</code>.</p><p>The input time Variable is <code>tforce</code>, with default linking to the <code>global.tforce</code> Variable.</p><p>Use the configuration file to rename output variable <code>F</code> (and if necessary, the input Variable <code>tforce</code>).</p><p>NB: no extrapolation ! (so eg set guard values for <code>perturb_times</code> at -1e30, 1e30)</p><p><strong>Parameters</strong></p><ul><li><code>field_data[DataType]</code>=PALEOboxes.ScalarData, <code>default_value</code>=PALEOboxes.ScalarData, <code>allowed_values</code>=Type[PALEOboxes.ScalarData, PALEOboxes.IsotopeLinear], <code>description</code>=&quot;disable / enable isotopes and specify isotope type&quot;</li><li><code>perturb_times[Vector{Float64}]</code>=[-1.0e30, 1.0e30]  (yr), <code>default_value</code>=[-1.0e30, 1.0e30], <code>description</code>=&quot;interpolated perturbation times&quot;</li><li><code>perturb_totals[Vector{Float64}]</code>=[1.0, 1.0]  (mol yr-1), <code>default_value</code>=[1.0, 1.0], <code>description</code>=&quot;interpolated perturbation totals&quot;</li><li><code>perturb_deltas[Vector{Float64}]</code>=[0.0, 0.0]  (per mil), <code>default_value</code>=[0.0, 0.0], <code>description</code>=&quot;interpolated perturbation deltas&quot;</li></ul><p><strong>Methods and Variables</strong></p><ul><li><code>do_flux_perturb</code><ul><li><code>tforce</code> –&gt; global.tforce  (yr), <code>VT_ReactDependency</code>, <code>description</code>=&quot;time at which to apply perturbation&quot;</li><li><code>F</code>  (mol yr-1), <code>VT_ReactContributor</code>, <code>description</code>=&quot;interpolated flux perturbation&quot;</li><li><code>FApplied</code> –&gt; %reaction%FApplied  (mol yr-1), <code>VT_ReactProperty</code>, <code>description</code>=&quot;flux perturbation applied, for diagnostic output&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/FluxPerturb.jl#L17-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.FluxPerturb.ReactionRestore" href="#PALEOboxes.FluxPerturb.ReactionRestore"><code>PALEOboxes.FluxPerturb.ReactionRestore</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionRestore</code></pre><p>Adds <code>RestoringFlux</code> in response to discrepancy between Variable <code>WatchLevel</code> and Parameter <code>RequiredLevel</code></p><p><strong>Parameters</strong></p><ul><li><code>field_data[DataType]</code>=PALEOboxes.ScalarData, <code>default_value</code>=PALEOboxes.ScalarData, <code>allowed_values</code>=Type[PALEOboxes.ScalarData, PALEOboxes.IsotopeLinear], <code>description</code>=&quot;disable / enable isotopes and specify isotope type&quot;</li><li><code>RequiredLevel[Float64]</code>=0.0  (mol), <code>default_value</code>=0.0, <code>description</code>=&quot;target value of WatchLevel&quot;</li><li><code>trestore[Float64]</code>=1.0  (yr), <code>default_value</code>=1.0, <code>description</code>=&quot;restoring timescale&quot;</li><li><code>RequiredDelta[Float64]</code>=0.0  (per mil), <code>default_value</code>=0.0, <code>description</code>=&quot;target value of WatchLevel delta&quot;</li><li><code>source_only[Bool]</code>=false, <code>default_value</code>=false, <code>description</code>=&quot;false to allow input and output, true to allow input only&quot;</li></ul><p><strong>Methods and Variables</strong></p><ul><li><code>do_restore</code><ul><li><code>WatchLevel</code>  (mol), <code>VT_ReactDependency</code>, <code>description</code>=&quot;level to observe and restore&quot;</li><li><code>RestoringFlux</code>  (mol yr-1), <code>VT_ReactContributor</code>, <code>description</code>=&quot;restoring flux&quot;</li><li><code>RestoringApplied</code> –&gt; %reaction%RestoringApplied  (mol yr-1), <code>VT_ReactProperty</code>, <code>description</code>=&quot;restoring flux for diagnostic output&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/FluxPerturb.jl#L135-L145">source</a></section></article><h2 id="Grids"><a class="docs-heading-anchor" href="#Grids">Grids</a><a id="Grids-1"></a><a class="docs-heading-anchor-permalink" href="#Grids" title="Permalink"></a></h2><p>Minimal generic model grids for test purposes.</p><p>These just define the Domain size, and don&#39;t provide coordinate or metric information (cell volume, area).  Models will usually require a Reaction with a Domain-specific implementation (eg for ocean, atmosphere) that defines coordinates and volumes etc and also implements transport (advection, eddy diffusion, etc).</p><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.GridReactions.ReactionUnstructuredVectorGrid" href="#PALEOboxes.GridReactions.ReactionUnstructuredVectorGrid"><code>PALEOboxes.GridReactions.ReactionUnstructuredVectorGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionUnstructuredVectorGrid</code></pre><p>Create an <a href="../DomainsVariablesFields/#PALEOboxes.Grids.UnstructuredVectorGrid"><code>PB.Grids.UnstructuredVectorGrid</code></a> with <code>ncells</code> (from <code>ncells</code> Parameter).</p><p><strong>Parameters</strong></p><ul><li><code>ncells[Int64]</code>=1, <code>default_value</code>=1, <code>description</code>=&quot;number of grid cells&quot;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/GridReactions.jl#L9-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.GridReactions.ReactionCartesianGrid" href="#PALEOboxes.GridReactions.ReactionCartesianGrid"><code>PALEOboxes.GridReactions.ReactionCartesianGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionCartesianGrid</code></pre><p>Create a <a href="../DomainsVariablesFields/#PALEOboxes.Grids.CartesianArrayGrid"><code>PB.Grids.CartesianArrayGrid</code></a> with <code>dims</code> and <code>dimnames</code>`</p><p><strong>Parameters</strong></p><ul><li><code>dimnames[Vector{String}]</code>=[&quot;lat&quot;, &quot;lon&quot;, &quot;z&quot;], <code>default_value</code>=[&quot;lat&quot;, &quot;lon&quot;, &quot;z&quot;], <code>description</code>=&quot;grid dimension names&quot;</li><li><code>dims[Vector{Int64}]</code>=[2, 3, 4], <code>default_value</code>=[2, 3, 4], <code>description</code>=&quot;grid dimensions&quot;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/GridReactions.jl#L41-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PALEOboxes.GridReactions.ReactionGrid2DNetCDF" href="#PALEOboxes.GridReactions.ReactionGrid2DNetCDF"><code>PALEOboxes.GridReactions.ReactionGrid2DNetCDF</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReactionGrid2DNetCDF</code></pre><p>Create a 2D <a href="../DomainsVariablesFields/#PALEOboxes.Grids.CartesianLinearGrid"><code>PB.Grids.CartesianLinearGrid</code></a> from grid information in a NetCDF file.</p><p><strong>Parameters</strong></p><ul><li><code>grid_type[UnionAll]</code>=PALEOboxes.Grids.CartesianArrayGrid, <code>default_value</code>=PALEOboxes.Grids.CartesianArrayGrid, <code>allowed_values</code>=Type[PALEOboxes.Grids.CartesianArrayGrid, PALEOboxes.Grids.CartesianLinearGrid], <code>description</code>=&quot;Cartesian grid type to create&quot;</li><li><code>grid_file[String]</code>=&quot;&quot;, <code>default_value</code>=&quot;&quot;, <code>description</code>=&quot;netcdf file with 2D grid information&quot;</li><li><code>coordinate_names[Vector{String}]</code>=[&quot;longitude&quot;, &quot;latitude&quot;], <code>default_value</code>=[&quot;longitude&quot;, &quot;latitude&quot;], <code>description</code>=&quot;coordinate names to read from netcdf file&quot;</li><li><code>equalspacededges[Bool]</code>=false, <code>default_value</code>=false, <code>description</code>=&quot;true to calculate cell edges assuming an equal-spaced grid&quot;</li><li><code>area_var[String]</code>=&quot;&quot;, <code>default_value</code>=&quot;&quot;, <code>description</code>=&quot;netcdf variable with cell area (if available)&quot;</li><li><code>planet_radius[Float64]</code>=6.371229e6, <code>default_value</code>=6.371229e6, <code>description</code>=&quot;radius to calculate cell area from spherical geometry (if area_var = &quot;&quot;)&quot;</li></ul><p><strong>Methods</strong></p><ul><li><code>setup_grid_2DNetCDF</code><ul><li><code>Asurf</code>  (m^2), <code>VT_ReactProperty</code>, <code>description</code>=&quot;horizontal area of surface&quot;</li><li><code>Asurf_total</code>  (m^2), <code>VT_ReactProperty</code>, <code>description</code>=&quot;total horizontal area of surface&quot;</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOboxes.jl/blob/77218d17fb9f444bb9b97bf5f90998e54f63b033/src/reactioncatalog/GridReactions.jl#L79-L89">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Reaction API/">« Reaction API</a><a class="docs-footer-nextpage" href="../References/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Friday 24 June 2022 20:15">Friday 24 June 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
